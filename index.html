<html>
	<head>
		<title></title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="Content-Script-Type" content="text/javascript">
		<meta http-equiv="Content-Style-Type" content="text/css">
		<link rel="stylesheet" href="https://cdn.usebootstrap.com/bootstrap/2.3.2/css/bootstrap.min.css"></link>
		<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script type="text/javascript" src="https://cdn.usebootstrap.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
		<script type="text/javascript">

function Client(){
	this.data	= {};
	this.logData = function(){
//		console.log(this.data);
//		console.log(this.data.modules);
	};
	this.render = function(){
		document.title = this.data.title;
		$("#header h2").html(this.data.title);
		$("#header p").html(this.data.description);
		var renderer = new Renderer();
		var modules = [];
		for(var module in this.data.modules){
			modules.push(renderer.renderModule(this.data.modules[module]));
		}
		var accordion = $('<div class="accordion" id="accordion-modules"></div>');
		accordion.append(modules);
		$("#modules").append(accordion);
	};
	this.onLoadData = function(data){
		this.data	= data;
		this.logData();
		this.render();
	};
	this.__init = async function(){
		await $.ajax({
			url: 'index.json',
			type: 'GET',
			context: this,
			success: this.onLoadData
		});
	};
	this.__init();
}

function Renderer(){
	this.renderModule = function(module){
//		console.log(module);
		var html = $('<div class="accordion-group"></div>');
		var heading = $('<div class="accordion-heading"></div>');
		var toggle = $('<a data-toggle="collapse" data-parent="#accordion-modules"></a>');
		toggle.addClass("accordion-toggle");
		toggle.prop("href", "#module-"+module.id.replace(/[_]/, '-'));
		toggle.html(module.title+' <small class="muted">'+module.version+'</small>');
		heading.append(toggle);
		var inner = $('<div class="accordion-inner"></div>')
		inner.html(this.renderModuleContent(module));
		var body = $('<div class="accordion-body collapse"></div>');
		body.prop("id", "module-"+module.id.replace(/[_]/, '-'));
		body.html(inner);
		html.append(heading).append(body);
		return html;
	};
	this.renderModuleContent = function(module){
		return module.description;
	}
}
		</script>
		<script type="text/javascript">$(document).ready(function(){var client = new Client()});</script>
		<style></style>
	</head>
	<body>
		<div class="container">
			<div id="header" class="hero-unit">
				<h2></h2>
				<p></p>
			</div>
			<div id="modules"></div>
		</div>
		<script></script>
	</body>
</html>

