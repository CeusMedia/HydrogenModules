<?xml version="1.0"?>
<module>
	<title>Users</title>
	<description>Basic user support and administration.</description>
	<version>0.3</version>
	<files>
		<class>Controller/Admin/User.php5</class>
		<class>Model/User.php5</class>
		<class>View/Admin/User.php5</class>
		<locale>de/admin/user.ini</locale>
		<template>admin/user/add.php</template>
		<template>admin/user/edit.php</template>
		<template>admin/user/index.php</template>
		<template>admin/user/index.filter.php</template>
		<template>admin/user/index.list.php</template>
		<style>site.user.css</style>
	</files>
	<relations>
		<needs type="module">Roles</needs>
	</relations>
	<config type="integer" name="name.length.min">3</config>										; lowest number of name characters
	<config type="integer" name="name.length.max">17</config>										; highest number of name characters
	<config type="string"  name="name.preg">/[a-z]/i</config>										; regular expression to match with username
	<config type="integer" name="password.length.min">3</config>									; lowest number of password characters
	<config type="integer" name="password.strength.min">0</config>									; highest number of password characters
	<config type="boolean" name="email.mandatory">no</config>										; user needs a mail address on register and change
	<config type="integer" name="status.register">1</config>										; user status to be set on register, set to 1 for "auto active"
	<link xml:lang="de" access="acl" path="admin/user" rank="60">Benutzer</link>
	<link xml:lang="en" access="acl" path="admin/user" rank="60">Users</link>
	<sql on="install" type="mysql"><![CDATA[

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";

CREATE TABLE IF NOT EXISTS `<%?prefix%>users` (
  `userId` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `roleId` int(11) unsigned DEFAULT NULL,
  `status` tinyint(1) NOT NULL,
  `email` varchar(200) COLLATE utf8_unicode_ci DEFAULT NULL,
  `username` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
  `password` varchar(32) COLLATE utf8_unicode_ci NOT NULL,
  `createdAt` decimal(12,0) NOT NULL,
  `modifiedAt` decimal(12,0) DEFAULT NULL,
  `loggedAt` decimal(12,0) DEFAULT NULL,
  `activeAt` decimal(12,0) DEFAULT NULL,
  PRIMARY KEY (`userId`),
  KEY `roleId` (`roleId`,`status`,`email`,`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;

]]>
	</sql>
	<sql on="install" type="sqlite"><![CDATA[
DROP TABLE IF EXISTS "<%?prefix%>users";
CREATE TABLE "<%?prefix%>users" (
	"userId" INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL ,
	"roleId" INTEGER,
	"status" INTEGER,
	"username" VARCHAR,
	"password" VARCHAR,
	"email" VARCHAR,
	"createdAt" DECIMAL,
	"modifiedAt" DECIMAL,
	"loggedAt" DECIMAL,
	"activeAt" DECIMAL
	);

]]>
	</sql>
	
	<sql on="uninstall" type="mysql"><![CDATA[
DROP TABLE IF EXISTS `<%?prefix%>users`;
]]>
	</sql>
	<sql on="uninstall" type="sqlite"><![CDATA[
DROP TABLE IF EXISTS "<%?prefix%>users";
]]>
	</sql>
</module>

